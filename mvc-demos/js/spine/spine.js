(function(){var k,m,l,q,n,i,h,s,o,t,r,j=[].slice,u=[].indexOf||function(f){for(var a=0,b=this.length;a<b;a++)if(a in this&&this[a]===f)return a;return-1},v={}.hasOwnProperty,p=function(f,a){function b(){this.constructor=f}for(var c in a)v.call(a,c)&&(f[c]=a[c]);b.prototype=a.prototype;f.prototype=new b;f.__super__=a.prototype;return f},w=function(f,a){return function(){return f.apply(a,arguments)}};l={bind:function(f,a){var b,c,d,e,g;c=f.split(" ");b=this.hasOwnProperty("_callbacks")&&this._callbacks||
(this._callbacks={});e=0;for(g=c.length;e<g;e++)d=c[e],b[d]||(b[d]=[]),b[d].push(a);return this},one:function(f,a){return this.bind(f,function(){this.unbind(f,arguments.callee);return a.apply(this,arguments)})},trigger:function(){var f,a,b,c,d;f=1<=arguments.length?j.call(arguments,0):[];b=f.shift();if(b=this.hasOwnProperty("_callbacks")&&(null!=(a=this._callbacks)?a[b]:void 0)){c=0;for(d=b.length;c<d&&!(a=b[c],!1===a.apply(this,f));c++);return!0}},unbind:function(f,a){var b,c,d,e,g;if(!f)return this._callbacks=
{},this;d=null!=(b=this._callbacks)?b[f]:void 0;if(!d)return this;if(!a)return delete this._callbacks[f],this;c=e=0;for(g=d.length;e<g;c=++e)if(b=d[c],b===a){d=d.slice();d.splice(c,1);this._callbacks[f]=d;break}return this}};q={trace:!0,logPrefix:"(App)",log:function(){var f;f=1<=arguments.length?j.call(arguments,0):[];if(this.trace)return this.logPrefix&&f.unshift(this.logPrefix),"undefined"!==typeof console&&null!==console&&"function"===typeof console.log&&console.log.apply(console,f),this}};r=
["included","extended"];i=function(){function f(){"function"===typeof this.init&&this.init.apply(this,arguments)}f.include=function(a){var b,c,d;if(!a)throw"include(obj) requires obj";for(b in a)c=a[b],0>u.call(r,b)&&(this.prototype[b]=c);null!=(d=a.included)&&d.apply(this);return this};f.extend=function(a){var b,c,d;if(!a)throw"extend(obj) requires obj";for(b in a)c=a[b],0>u.call(r,b)&&(this[b]=c);null!=(d=a.extended)&&d.apply(this);return this};f.proxy=function(a){var b=this;return function(){return a.apply(b,
arguments)}};f.prototype.proxy=function(a){var b=this;return function(){return a.apply(b,arguments)}};return f}();n=function(f){function a(b){a.__super__.constructor.apply(this,arguments);b&&this.load(b);this.cid=this.constructor.uid("c-")}p(a,f);a.extend(l);a.records={};a.crecords={};a.attributes=[];a.configure=function(){var b,c;c=arguments[0];b=2<=arguments.length?j.call(arguments,1):[];this.className=c;this.records={};this.crecords={};b.length&&(this.attributes=b);this.attributes&&(this.attributes=
t(this.attributes));this.attributes||(this.attributes=[]);this.unbind();return this};a.toString=function(){return""+this.className+"("+this.attributes.join(", ")+")"};a.find=function(b){var c;c=this.records[b];if(!c&&(""+b).match(/c-\d+/))return this.findCID(b);if(!c)throw"Unknown record";return c.clone()};a.findCID=function(b){b=this.crecords[b];if(!b)throw"Unknown record";return b.clone()};a.exists=function(b){try{return this.find(b)}catch(c){return!1}};a.refresh=function(b,c){var a,e,g,f;null==
c&&(c={});c.clear&&(this.records={},this.crecords={});e=this.fromJSON(b);o(e)||(e=[e]);g=0;for(f=e.length;g<f;g++)a=e[g],a.id||(a.id=a.cid),this.records[a.id]=a,this.crecords[a.cid]=a;this.trigger("refresh",this.cloneArray(e));return this};a.select=function(b){var c,a,e,g;e=this.records;g=[];for(c in e)a=e[c],b(a)&&g.push(a);return this.cloneArray(g)};a.findByAttribute=function(b,c){var a,e,g;g=this.records;for(a in g)if(e=g[a],e[b]===c)return e.clone();return null};a.findAllByAttribute=function(b,
c){return this.select(function(a){return a[b]===c})};a.each=function(b){var c,a,e,g;e=this.records;g=[];for(c in e)a=e[c],g.push(b(a.clone()));return g};a.all=function(){return this.cloneArray(this.recordsValues())};a.first=function(){var b;b=this.recordsValues()[0];return null!=b?b.clone():void 0};a.last=function(){var b;b=this.recordsValues();b=b[b.length-1];return null!=b?b.clone():void 0};a.count=function(){return this.recordsValues().length};a.deleteAll=function(){var b,c,a;c=this.records;a=
[];for(b in c)a.push(delete this.records[b]);return a};a.destroyAll=function(){var b,a,d;a=this.records;d=[];for(b in a)d.push(this.records[b].destroy());return d};a.update=function(b,a,d){return this.find(b).updateAttributes(a,d)};a.create=function(b,a){return(new this(b)).save(a)};a.destroy=function(b,a){return this.find(b).destroy(a)};a.change=function(b){return"function"===typeof b?this.bind("change",b):this.trigger("change",b)};a.fetch=function(b){return"function"===typeof b?this.bind("fetch",
b):this.trigger("fetch",b)};a.toJSON=function(){return this.recordsValues()};a.fromJSON=function(b){var a,d,e,g;if(b){"string"===typeof b&&(b=JSON.parse(b));if(o(b)){g=[];d=0;for(e=b.length;d<e;d++)a=b[d],g.push(new this(a));return g}return new this(b)}};a.fromForm=function(){var b;return(b=new this).fromForm.apply(b,arguments)};a.recordsValues=function(){var b,a,d,e;a=[];e=this.records;for(b in e)d=e[b],a.push(d);return a};a.cloneArray=function(b){var a,d,e,g;g=[];d=0;for(e=b.length;d<e;d++)a=b[d],
g.push(a.clone());return g};a.idCounter=0;a.uid=function(b){null==b&&(b="");return b+this.idCounter++};a.prototype.isNew=function(){return!this.exists()};a.prototype.isValid=function(){return!this.validate()};a.prototype.validate=function(){};a.prototype.load=function(b){var a,d;for(a in b)if(d=b[a],"function"===typeof this[a])this[a](d);else this[a]=d;return this};a.prototype.attributes=function(){var b,a,d,e,g;a={};g=this.constructor.attributes;d=0;for(e=g.length;d<e;d++)b=g[d],b in this&&(a[b]=
"function"===typeof this[b]?this[b]():this[b]);this.id&&(a.id=this.id);return a};a.prototype.eql=function(b){return!!(b&&b.constructor===this.constructor&&b.cid===this.cid||b.id&&b.id===this.id)};a.prototype.save=function(b){var a;null==b&&(b={});if(!1!==b.validate&&(a=this.validate()))return this.trigger("error",a),!1;this.trigger("beforeSave",b);a=this.isNew()?this.create(b):this.update(b);this.trigger("save",b);return a};a.prototype.updateAttribute=function(b,a,d){this[b]=a;return this.save(d)};
a.prototype.updateAttributes=function(b,a){this.load(b);return this.save(a)};a.prototype.changeID=function(b){var a;a=this.constructor.records;a[b]=a[this.id];delete a[this.id];this.id=b;return this.save()};a.prototype.destroy=function(b){null==b&&(b={});this.trigger("beforeDestroy",b);delete this.constructor.records[this.id];delete this.constructor.crecords[this.cid];this.destroyed=!0;this.trigger("destroy",b);this.trigger("change","destroy",b);this.unbind();return this};a.prototype.dup=function(b){var a;
a=new this.constructor(this.attributes());!1===b?a.cid=this.cid:delete a.id;return a};a.prototype.clone=function(){return s(this)};a.prototype.reload=function(){var b;if(this.isNew())return this;b=this.constructor.find(this.id);this.load(b.attributes());return b};a.prototype.toJSON=function(){return this.attributes()};a.prototype.toString=function(){return"<"+this.constructor.className+" ("+JSON.stringify(this)+")>"};a.prototype.fromForm=function(b){var a,d,e,g;a={};g=k(b).serializeArray();d=0;for(e=
g.length;d<e;d++)b=g[d],a[b.name]=b.value;return this.load(a)};a.prototype.exists=function(){return this.id&&this.id in this.constructor.records};a.prototype.update=function(b){var a;this.trigger("beforeUpdate",b);a=this.constructor.records;a[this.id].load(this.attributes());a=a[this.id].clone();a.trigger("update",b);a.trigger("change","update",b);return a};a.prototype.create=function(b){var a;this.trigger("beforeCreate",b);this.id||(this.id=this.cid);a=this.dup(!1);this.constructor.records[this.id]=
a;this.constructor.crecords[this.cid]=a;a=a.clone();a.trigger("create",b);a.trigger("change","create",b);return a};a.prototype.bind=function(a,c){var d,e,g=this;this.constructor.bind(a,d=function(a){if(a&&g.eql(a))return c.apply(g,arguments)});this.constructor.bind("unbind",e=function(c){if(c&&g.eql(c))return g.constructor.unbind(a,d),g.constructor.unbind("unbind",e)});return d};a.prototype.one=function(a,c){var d,e=this;return d=this.bind(a,function(){e.constructor.unbind(a,d);return c.apply(e,arguments)})};
a.prototype.trigger=function(){var a,c;a=1<=arguments.length?j.call(arguments,0):[];a.splice(1,0,this);return(c=this.constructor).trigger.apply(c,a)};a.prototype.unbind=function(){return this.trigger("unbind")};return a}(i);m=function(f){function a(b){this.release=w(this.release,this);var c,d,e;e=this.options=b;for(c in e)d=e[c],this[c]=d;this.el||(this.el=document.createElement(this.tag));this.el=k(this.el);this.className&&this.el.addClass(this.className);this.attributes&&this.el.attr(this.attributes);
this.events||(this.events=this.constructor.events);this.elements||(this.elements=this.constructor.elements);this.events&&this.delegateEvents(this.events);this.elements&&this.refreshElements();a.__super__.constructor.apply(this,arguments)}p(a,f);a.include(l);a.include(q);a.prototype.eventSplitter=/^(\S+)\s*(.*)$/;a.prototype.tag="div";a.prototype.release=function(){this.trigger("release");this.el.remove();return this.unbind()};a.prototype.$=function(a){return k(a,this.el)};a.prototype.delegateEvents=
function(a){var c,d,e,g,f,h=this;f=[];for(d in a)g=a[d],g="function"===typeof g?function(a){return function(){a.apply(h,arguments);return!0}}(g):function(a){return function(){h[a].apply(h,arguments);return!0}}(g),e=d.match(this.eventSplitter),c=e[1],e=e[2],""===e?f.push(this.el.bind(c,g)):f.push(this.el.delegate(e,c,g));return f};a.prototype.refreshElements=function(){var a,c,d,e;d=this.elements;e=[];for(a in d)c=d[a],e.push(this[c]=this.$(a));return e};a.prototype.delay=function(a,c){return setTimeout(this.proxy(a),
c||0)};a.prototype.html=function(a){this.el.html(a.el||a);this.refreshElements();return this.el};a.prototype.append=function(){var a,c,d;c=1<=arguments.length?j.call(arguments,0):[];var e,f,h;h=[];e=0;for(f=c.length;e<f;e++)a=c[e],h.push(a.el||a);(d=this.el).append.apply(d,h);this.refreshElements();return this.el};a.prototype.appendTo=function(a){this.el.appendTo(a.el||a);this.refreshElements();return this.el};a.prototype.prepend=function(){var a,c,d;c=1<=arguments.length?j.call(arguments,0):[];var e,
f,h;h=[];e=0;for(f=c.length;e<f;e++)a=c[e],h.push(a.el||a);(d=this.el).prepend.apply(d,h);this.refreshElements();return this.el};a.prototype.replace=function(a){var c;c=[this.el,k(a.el||a)];a=c[0];this.el=c[1];a.replaceWith(this.el);this.delegateEvents(this.events);this.refreshElements();return this.el};return a}(i);k=("undefined"!==typeof window&&null!==window?window.jQuery:void 0)||("undefined"!==typeof window&&null!==window?window.Zepto:void 0)||function(f){return f};s=Object.create||function(f){var a;
a=function(){};a.prototype=f;return new a};o=function(f){return"[object Array]"===Object.prototype.toString.call(f)};t=function(f){return Array.prototype.slice.call(f,0)};h=this.Spine={};"undefined"!==typeof module&&null!==module&&(module.exports=h);h.version="1.0.6";h.isArray=o;h.isBlank=function(f){var a;if(!f)return true;for(a in f)return false;return true};h.$=k;h.Events=l;h.Log=q;h.Module=i;h.Controller=m;h.Model=n;i.extend.call(h,l);i.create=i.sub=m.create=m.sub=n.sub=function(f,a){var b;b=
function(a){function b(){return b.__super__.constructor.apply(this,arguments)}p(b,a);return b}(this);f&&b.include(f);a&&b.extend(a);typeof b.unbind==="function"&&b.unbind();return b};n.setup=function(f,a){var b;a==null&&(a=[]);b=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}p(b,a);return b}(this);b.configure.apply(b,[f].concat(j.call(a)));return b};h.Class=i}).call(this);